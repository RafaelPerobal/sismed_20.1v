-- Criar tabelas principais
CREATE TABLE IF NOT EXISTS patients (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    nome TEXT NOT NULL,
    cpf TEXT UNIQUE NOT NULL,
    data_nascimento TEXT NOT NULL
);

CREATE TABLE IF NOT EXISTS medicines (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    nome TEXT NOT NULL,
    dosagem TEXT,
    apresentacao TEXT,
    controlado INTEGER NOT NULL DEFAULT 0,
    UNIQUE(nome, dosagem, apresentacao)
);

CREATE TABLE IF NOT EXISTS posologies (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    texto TEXT NOT NULL UNIQUE
);

CREATE TABLE IF NOT EXISTS prescriptions (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    patient_id INTEGER NOT NULL,
    data TEXT NOT NULL,
    observacoes TEXT,
    FOREIGN KEY (patient_id) REFERENCES patients (id) ON DELETE CASCADE
);

CREATE TABLE IF NOT EXISTS prescription_medicines (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    prescription_id INTEGER NOT NULL,
    medicine_id INTEGER NOT NULL,
    posologia TEXT,
    FOREIGN KEY (prescription_id) REFERENCES prescriptions (id) ON DELETE CASCADE,
    FOREIGN KEY (medicine_id) REFERENCES medicines (id)
);

-- Inserir medicamentos iniciais (36 medicamentos oficiais)
INSERT OR IGNORE INTO medicines (nome, dosagem, apresentacao, controlado) VALUES
('PARACETAMOL', '500MG', 'COMPRIMIDO', 0),
('IBUPROFENO', '600MG', 'COMPRIMIDO', 0),
('DIPIRONA', '500MG', 'COMPRIMIDO', 0),
('AMOXICILINA', '500MG', 'CAPSULA', 0),
('AZITROMICINA', '500MG', 'COMPRIMIDO', 0),
('OMEPRAZOL', '20MG', 'CAPSULA', 0),
('LOSARTANA', '50MG', 'COMPRIMIDO', 0),
('ATENOLOL', '25MG', 'COMPRIMIDO', 0),
('HIDROCLOROTIAZIDA', '25MG', 'COMPRIMIDO', 0),
('METFORMINA', '850MG', 'COMPRIMIDO', 0),
('GLIBENCLAMIDA', '5MG', 'COMPRIMIDO', 0),
('SINVASTATINA', '20MG', 'COMPRIMIDO', 0),
('CAPTOPRIL', '25MG', 'COMPRIMIDO', 0),
('ENALAPRIL', '10MG', 'COMPRIMIDO', 0),
('PROPRANOLOL', '40MG', 'COMPRIMIDO', 0),
('FUROSEMIDA', '40MG', 'COMPRIMIDO', 0),
('ESPIRONOLACTONA', '25MG', 'COMPRIMIDO', 0),
('DIGOXINA', '0,25MG', 'COMPRIMIDO', 0),
('WARFARINA', '5MG', 'COMPRIMIDO', 0),
('HEPARINA', '5000UI/ML', 'AMPOLA', 0),
('INSULINA NPH', '100UI/ML', 'FRASCO', 0),
('INSULINA REGULAR', '100UI/ML', 'FRASCO', 0),
('PREDNISONA', '20MG', 'COMPRIMIDO', 0),
('DEXAMETASONA', '4MG', 'COMPRIMIDO', 0),
('LEVOTIROXINA', '50MCG', 'COMPRIMIDO', 0),
('CARBAMAZEPINA', '200MG', 'COMPRIMIDO', 1),
('FENITOINA', '100MG', 'COMPRIMIDO', 1),
('ACIDO VALPROICO', '250MG', 'COMPRIMIDO', 1),
('DIAZEPAM', '10MG', 'COMPRIMIDO', 1),
('CLONAZEPAM', '2MG', 'COMPRIMIDO', 1),
('ALPRAZOLAM', '0,5MG', 'COMPRIMIDO', 1),
('FLUOXETINA', '20MG', 'CAPSULA', 1),
('SERTRALINA', '50MG', 'COMPRIMIDO', 1),
('AMITRIPTILINA', '25MG', 'COMPRIMIDO', 1),
('HALOPERIDOL', '5MG', 'COMPRIMIDO', 1),
('RISPERIDONA', '2MG', 'COMPRIMIDO', 1);

-- Inserir posologias padrão
INSERT OR IGNORE INTO posologies (texto) VALUES
('1 COMPRIMIDO DE 8 EM 8 HORAS'),
('1 COMPRIMIDO DE 12 EM 12 HORAS'),
('1 COMPRIMIDO PELA MANHÃ'),
('1 COMPRIMIDO À NOITE'),
('1 COMPRIMIDO 3 VEZES AO DIA'),
('1 COMPRIMIDO EM JEJUM'),
('1 COMPRIMIDO APÓS AS REFEIÇÕES'),
('CONFORME ORIENTAÇÃO MÉDICA'),
('APLICAR 1 AMPOLA INTRAMUSCULAR'),
('APLICAR CONFORME NECESSÁRIO');

-- Inserir pacientes iniciais (35 pacientes)
INSERT OR IGNORE INTO patients (nome, cpf, data_nascimento) VALUES
('MARIA DA SILVA SANTOS', '12345678901', '1980-05-15'),
('JOÃO PEREIRA OLIVEIRA', '23456789012', '1975-08-22'),
('ANA COSTA FERREIRA', '34567890123', '1990-12-10'),
('CARLOS RODRIGUES LIMA', '45678901234', '1965-03-18'),
('LUCIA ALMEIDA SOUZA', '56789012345', '1985-07-25'),
('PEDRO MARTINS SILVA', '67890123456', '1970-11-30'),
('FERNANDA RIBEIRO COSTA', '78901234567', '1995-01-08'),
('ANTONIO GOMES PEREIRA', '89012345678', '1960-09-14'),
('PATRICIA SANTOS OLIVEIRA', '90123456789', '1988-04-20'),
('RICARDO LIMA FERREIRA', '01234567890', '1972-06-12'),
('SANDRA COSTA RODRIGUES', '11234567890', '1983-10-05'),
('MARCOS SILVA ALMEIDA', '21234567890', '1977-02-28'),
('CLAUDIA PEREIRA SOUZA', '31234567890', '1992-08-16'),
('ROBERTO OLIVEIRA MARTINS', '41234567890', '1968-12-03'),
('HELENA FERREIRA RIBEIRO', '51234567890', '1986-05-21'),
('EDUARDO SANTOS GOMES', '61234567890', '1974-09-07'),
('MONICA LIMA COSTA', '71234567890', '1991-01-24'),
('SERGIO RODRIGUES SILVA', '81234567890', '1963-07-11'),
('CRISTINA ALMEIDA PEREIRA', '91234567890', '1989-03-19'),
('FERNANDO SOUZA OLIVEIRA', '02345678901', '1976-11-26'),
('REGINA MARTINS FERREIRA', '12345678902', '1984-06-13'),
('PAULO RIBEIRO SANTOS', '22345678901', '1971-10-09'),
('SILVIA GOMES LIMA', '32345678901', '1993-02-15'),
('ANDRE COSTA RODRIGUES', '42345678901', '1967-08-02'),
('MARCIA SILVA ALMEIDA', '52345678901', '1987-12-18'),
('LUIZ PEREIRA SOUZA', '62345678901', '1973-04-25'),
('DENISE OLIVEIRA MARTINS', '72345678901', '1990-09-12'),
('JOSE FERREIRA RIBEIRO', '82345678901', '1962-01-29'),
('CARLA SANTOS GOMES', '92345678901', '1988-07-06'),
('WAGNER LIMA COSTA', '03456789012', '1975-11-23'),
('VERA RODRIGUES SILVA', '13456789012', '1985-03-10'),
('DANIEL ALMEIDA PEREIRA', '23456789013', '1979-09-27'),
('ROSANA SOUZA OLIVEIRA', '33456789012', '1994-05-14'),
('FLAVIO MARTINS FERREIRA', '43456789012', '1966-01-01'),
('SIMONE RIBEIRO SANTOS', '53456789012', '1982-08-08');