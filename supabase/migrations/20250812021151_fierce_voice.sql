-- Criar tabelas principais
CREATE TABLE IF NOT EXISTS patients (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    nome TEXT NOT NULL,
    cpf TEXT UNIQUE NOT NULL,
    data_nascimento TEXT NOT NULL
);

CREATE TABLE IF NOT EXISTS medicines (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    nome TEXT NOT NULL,
    dosagem TEXT,
    apresentacao TEXT,
    controlado INTEGER NOT NULL DEFAULT 0,
    UNIQUE(nome, dosagem, apresentacao)
);

CREATE TABLE IF NOT EXISTS posologies (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    texto TEXT NOT NULL UNIQUE
);

CREATE TABLE IF NOT EXISTS prescriptions (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    patient_id INTEGER NOT NULL,
    data TEXT NOT NULL,
    observacoes TEXT,
    FOREIGN KEY (patient_id) REFERENCES patients (id) ON DELETE CASCADE
);

CREATE TABLE IF NOT EXISTS prescription_medicines (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    prescription_id INTEGER NOT NULL,
    medicine_id INTEGER NOT NULL,
    posologia TEXT,
    FOREIGN KEY (prescription_id) REFERENCES prescriptions (id) ON DELETE CASCADE,
    FOREIGN KEY (medicine_id) REFERENCES medicines (id)
);

-- Inserir medicamentos oficiais (36 medicamentos)
INSERT OR IGNORE INTO medicines (nome, dosagem, apresentacao, controlado) VALUES
('AMITRIPTILINA', '25MG', 'COMPRIMIDO', 0),
('ÁCIDO VALPROICO', '250MG', 'COMPRIMIDO', 0),
('ÁCIDO VALPROICO', '500MG', 'COMPRIMIDO', 0),
('ÁCIDO VALPROICO', '50MG/ML', 'SUSPENSÃO ORAL', 0),
('BIPERIDENO CLORIDRATO', '2MG', 'COMPRIMIDO', 1),
('CARBAMAZEPINA', '200MG', 'COMPRIMIDO', 0),
('CARBAMAZEPINA', '20MG/ML', 'SUSPENSÃO', 0),
('CARBONATO DE LÍTIO', '300MG', 'COMPRIMIDO', 1),
('CLOMIPRAMINA CLORIDRATO', '25MG', 'COMPRIMIDO', 0),
('CLONAZEPAM', '2MG', 'COMPRIMIDO', 1),
('CLONAZEPAM', '2.5MG/ML', 'SOLUÇÃO ORAL', 1),
('CLORPROMAZINA CLORIDRATO', '25MG', 'COMPRIMIDO', 1),
('CLORPROMAZINA CLORIDRATO', '100MG', 'COMPRIMIDO', 1),
('DESVENLAFAXINA SUCCINATO', '50MG', 'COMPRIMIDO', 0),
('DIAZEPAM', '5MG', 'COMPRIMIDO', 1),
('DIAZEPAM', '10MG', 'COMPRIMIDO', 1),
('ESCITALOPRAM', '10MG', 'COMPRIMIDO', 0),
('FENITOÍNA SÓDICA', '100MG', 'COMPRIMIDO', 1),
('FENOBARBITAL', '100MG', 'COMPRIMIDO', 1),
('FENOBARBITAL', '40MG/ML', 'SOLUÇÃO ORAL', 1),
('FLUOXETINA', '20MG', 'CÁPSULA/COMPRIMIDO', 0),
('HALOPERIDOL', '1MG', 'COMPRIMIDO', 1),
('HALOPERIDOL', '5MG', 'COMPRIMIDO', 1),
('HALOPERIDOL', '2MG/ML', 'SOLUÇÃO ORAL', 1),
('HALOPERIDOL DECANOATO', '50MG/ML', 'SOLUÇÃO INJETÁVEL', 1),
('IMIPRAMINA CLORIDRATO', '25MG', 'COMPRIMIDO', 0),
('LEVOMEPROMAZINA', '25MG', 'COMPRIMIDO', 1),
('LEVOMEPROMAZINA', '100MG', 'COMPRIMIDO', 1),
('MIRTAZAPINA', '30MG', 'COMPRIMIDO', 0),
('NORTRIPTILINA CLORIDRATO', '25MG', 'COMPRIMIDO', 0),
('OXCARBAZEPINA', '600MG', 'COMPRIMIDO', 0),
('OXCARBAZEPINA', '60MG/ML', 'SOLUÇÃO ORAL', 0),
('PAROXETINA CLORIDRATO', '20MG', 'COMPRIMIDO', 0),
('PREGABALINA', '75MG', 'COMPRIMIDO', 1),
('SERTRALINA CLORIDRATO', '50MG', 'COMPRIMIDO', 0),
('VENLAFAXINA CLORIDRATO', '75MG', 'COMPRIMIDO', 0);

-- Inserir posologias padrão
INSERT OR IGNORE INTO posologies (texto) VALUES
('1 COMPRIMIDO DE 8 EM 8 HORAS'),
('1 COMPRIMIDO DE 12 EM 12 HORAS'),
('1 COMPRIMIDO PELA MANHÃ'),
('1 COMPRIMIDO À NOITE'),
('1 COMPRIMIDO 3 VEZES AO DIA'),
('1 COMPRIMIDO EM JEJUM'),
('1 COMPRIMIDO APÓS AS REFEIÇÕES'),
('CONFORME ORIENTAÇÃO MÉDICA'),
('APLICAR 1 AMPOLA INTRAMUSCULAR'),
('APLICAR CONFORME NECESSÁRIO');

-- Inserir pacientes iniciais (35 pacientes)
INSERT OR IGNORE INTO patients (nome, cpf, data_nascimento) VALUES
('IGOR MARTINS FERREIRA', '707103879941220', '2001-03-27'),
('MARIA VERONICE GARBUGIO CASAVECHIA', '701207023822217', '1957-10-31'),
('VANESSA CASAVECHIA CIA', '709608626663377', '1980-08-11'),
('EDILMA CRIVOI', '700904925268690', '1978-03-27'),
('JOÃO RODRIGUES D´ALARME', '898003946575562', '1940-01-12'),
('MARCIO RISATO CAMPIOLO', '709004887035819', '1985-05-27'),
('RAIMUNDO EDSON FERREIRA LIMA', '704007311548060', '1972-03-11'),
('WILMAR FERREIRA LIMA', '708907776199410', '1969-11-06'),
('ALIFER SOARES', '704705785840430', '2019-05-26'),
('CAROLINA MARTINS MACHADO DOS SANTOS', '702500318940333', '1937-05-22'),
('CLEONICE LIMA NOVAES DE LIMA', '700005366280103', '1966-02-22'),
('THAIS NOVAES OLIVEIRA', '704202721578982', '2001-07-08'),
('DANIEL RISSATI', '700503387876955', '1948-08-13'),
('ELISANGELA GONÇCALVES PEREIRA FERREIRA', '700506975463158', '1983-03-07'),
('IRENE ALVES DE JESUS MILITÃO', '709000872717419', '1955-08-08'),
('JALVIR ROSSI BORGUEZANI', '700002064314908', '1972-05-18'),
('LUCAS THIAGO DE MACEDO', '709006830862610', '1994-04-14'),
('MARIA DA PIEDADE SILVEIRA PEREIRA', '707808653146010', '1968-08-17'),
('PAULO EDUARDO CASAVECHIA CIA', '705809438837130', '2000-10-28'),
('ZILDA CAVALHEIRO NOVAIS', '702303172287511', '1984-04-06'),
('SILVANA SPANSERKI DE ARAUJO', '701808251717774', '1971-10-19'),
('LIDIANE SPANSERKI DE ARAUJO', '700800440319681', '1999-05-06'),
('MICHELI FRANCO HORVATH', '700004591545606', '1988-01-14'),
('ROSIANE SILVA DE LIMA BASSI', '705000646866155', '1973-10-10'),
('GEFERSON DE SOUZA ALVES', '700909986860195', '2002-11-16'),
('GABRIEL EMANUEL ARAUJO DA SILVA', '700201971121021', '1994-10-28'),
('ANDERSON LIMA RODRIGUES DE ARAUJO', '702400557809824', '1999-06-23'),
('RODRIGO ROSA DA SILVA', '700601450655962', '1995-10-15'),
('RENATO ROSA DA SILVA', '705004002815159', '1997-10-05'),
('VALDETE NUNES PEREIRA', '708104147817040', '1977-08-22'),
('BRUNO PEREIRA DE MELLO', '702807632240865', '1999-03-07'),
('TEREZINHA DE FATIMA C. MATOSINHO', '700102417174220', '1958-04-28'),
('JOSEFA AMELIA PEREIRA LEAL', '705004414988557', '1962-07-03'),
('OSVALDO HORVATH', '700402942254050', '1949-08-15'),
('ANTONIA ROQUE RICARDO', '704800078864046', '1968-04-11');